<!DOCTYPE html>
<!-- saved from url=(0049)http://localhost:8888/notebooks/Chatbotoff2.ipynb -->
<html lang="en-in"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>Chatbotoff2 - Jupyter Notebook</title>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/jquery.typeahead.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Chatbotoff2 - Jupyter Notebook_files/MathJax.js.download" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distinguish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/codemirror.css">


    <link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/override.css" type="text/css">
<link rel="stylesheet" href="http://localhost:8888/notebooks/Chatbotoff2.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Chatbotoff2 - Jupyter Notebook_files/custom.css" type="text/css">
    <script src="./Chatbotoff2 - Jupyter Notebook_files/promise.min.js.download" type="text/javascript" charset="utf-8"></script>
    <script src="./Chatbotoff2 - Jupyter Notebook_files/react.production.min.js.download" type="text/javascript"></script>
    <script src="./Chatbotoff2 - Jupyter Notebook_files/react-dom.production.min.js.download" type="text/javascript"></script>
    <script src="./Chatbotoff2 - Jupyter Notebook_files/index.js.download" type="text/javascript"></script>
    <script src="./Chatbotoff2 - Jupyter Notebook_files/require.js.download" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20210305151052",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jed: 'components/jed/jed',
            jquery: 'components/jquery/jquery.min',
            json: 'components/requirejs-plugins/src/json',
            text: 'components/requirejs-text/text',
            bootstrap: 'components/bootstrap/dist/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/jquery-ui.min',
            moment: 'components/moment/min/moment-with-locales',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })

    document.nbjs_translations = {"domain": "nbjs", "locale_data": {"nbjs": {"": {"domain": "nbjs"}}}};
    document.documentElement.lang = navigator.language.toLowerCase();
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Chatbotoff2 - Jupyter Notebook_files/contents.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Chatbotoff2 - Jupyter Notebook_files/custom.js.download"></script><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./Chatbotoff2 - Jupyter Notebook_files/extension.js.download"></script><style type="text/css" id="nfe_style">a.nfe-extension-link.nfe-nofollow, a.nfe-extension-link.nfe-nofollow * {color: #000000; background-color: #FFD000 !important;}a.nfe-extension-link.nfe-nofollow img {border: 6px solid #FFD000 !important;}a.nfe-extension-link.nfe-follow, a.nfe-extension-link.nfe-follow * {color: #000000; background-color: #00FF00 !important;}a.nfe-extension-link.nfe-follow img {border: 6px solid #00FF00 !important;}</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css" id="tts-styles">[data-tts-block-id].tts-active {background: rgba(206, 225, 255, 0.9) !important;} [data-tts-sentence-id].tts-active {background: rgba(0, 89, 191, 0.7) !important;}</style><link id="favicon" type="image/x-icon" rel="shortcut icon" href="http://localhost:8888/static/base/images/favicon-busy-1.ico"></head>

<body class="notebook_app command_mode" data-jupyter-api-token="d636c3593627e98d4e628a8d42b37547ae329fc55899654b" data-base-url="/" data-ws-url="" data-notebook-name="Untitled4.ipynb" data-notebook-path="Untitled4.ipynb" dir="ltr"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed. 
  </div>
</noscript>

<div id="header" role="navigation" aria-label="Top Menu" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand"><a href="http://localhost:8888/tree?token=d636c3593627e98d4e628a8d42b37547ae329fc55899654b" title="dashboard">
      <img src="./Chatbotoff2 - Jupyter Notebook_files/logo.png" alt="Jupyter Notebook">
  </a></div>

  


<span id="save_widget" class="save_widget">
    <span id="notebook_name" class="filename">Chatbotoff2</span>
    <span class="checkpoint_status" title="Fri, Mar 5, 2021 3:43 PM">Last Checkpoint: 5 hours ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>


  

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" alt="Current Kernel Logo" src="./Chatbotoff2 - Jupyter Notebook_files/logo-64x64.png" title="Python 3" style="display: inline;">
  
</span>


  
  
  
  

    <span id="login_widget">
      
        <button id="logout" class="btn btn-sm navbar-btn">Logout</button>
      
    </span>

  

  
  
  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 3</span>
              <i id="kernel_indicator_icon" class="kernel_busy_icon" title="Kernel Busy"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="cursor: help;" disabled="disabled"><span title="Javascript enabled for notebook display">Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" id="filelink" data-toggle="dropdown" aria-haspopup="true" aria-controls="file_menu" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu" role="menu" aria-labelledby="filelink">
                        <li id="new_notebook" class="menu_focus_highlight dropdown dropdown-submenu" role="none">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">New Notebook<span class="sr-only">Dropdown</span></a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu" role="menu">
                            <li id="new-notebook-submenu-python3"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Python 3</a></li></ul>
                        </li>
                        <li id="open_notebook" role="none" title="Opens a new window with the Dashboard view">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider" role="none"></li>
                        <li id="copy_notebook" role="none" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Make a Copy...</a></li>
                        <li id="save_notebook_as" role="none" title="Save a copy of the notebook&#39;s contents and start a new kernel">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Save as...</a></li>
                        <li id="rename_notebook" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Rename...</a></li>
                        <li id="save_checkpoint" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Save and Checkpoint</span><span class="kb"><kbd>Ctrl-S</kbd></span></a></li>
                        <!-- <hr/> -->
                        <li class="divider" role="none"></li>
                        <li id="restore_checkpoint" class="menu_focus_highlight dropdown-submenu" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Revert to Checkpoint<span class="sr-only">Dropdown</span></a>
                          <ul class="dropdown-menu"><li><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Friday, March 5, 2021 3:43 PM</a></li></ul>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="print_preview" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Print Preview</a></li>
                        <li class="dropdown-submenu menu_focus_highlight" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Download as<span class="sr-only">Dropdown</span></a>
                            <ul id="download_menu" class="dropdown-menu">
                                
                                <li id="download_asciidoc">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">AsciiDoc (.asciidoc)</a>
                                </li>
                                
                                <li id="download_html">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">HTML (.html)</a>
                                </li>
                                
                                <li id="download_latex">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">LaTeX (.tex)</a>
                                </li>
                                
                                <li id="download_markdown">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Markdown (.md)</a>
                                </li>
                                
                                <li id="download_notebook">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Notebook (.ipynb)</a>
                                </li>
                                
                                <li id="download_pdf">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">PDF via LaTeX (.pdf)</a>
                                </li>
                                
                                <li id="download_rst">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">reST (.rst)</a>
                                </li>
                                
                                <li id="download_script">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Python (.py)</a>
                                </li>
                                
                                <li id="download_slides">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Reveal.js slides (.slides.html)</a>
                                </li>
                                
                                <li id="download_webpdf">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">PDF via pyppeteer (.html)</a>
                                </li>
                                
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="trust_notebook" role="none" title="Trust the output of this notebook" class="disabled">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Trusted Notebook</a></li>
                        <li class="divider" role="none"></li>
                        <li id="close_and_halt" role="none" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Close and Halt</a></li>
                    </ul>
                </li>

                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" id="editlink" data-toggle="dropdown" aria-haspopup="true" aria-controls="edit_menu">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu" role="menu" aria-labelledby="editlink">
                        <li id="cut_cell" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Cut Cells</span><span class="kb"><kbd>X</kbd></span></a></li>
                        <li id="copy_cell" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Copy Cells</span><span class="kb"><kbd>C</kbd></span></a></li>
                        <li id="paste_cell_above" class="disabled" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-disabled="true" class="menu-shortcut-container"><span class="action">Paste Cells Above</span><span class="kb"><kbd>Shift-V</kbd></span></a></li>
                        <li id="paste_cell_below" class="disabled" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-disabled="true" class="menu-shortcut-container"><span class="action">Paste Cells Below</span><span class="kb"><kbd>V</kbd></span></a></li>
                        <li id="paste_cell_replace" class="disabled" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-disabled="true">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Delete Cells</span><span class="kb"><kbd>D</kbd>,<kbd>D</kbd></span></a></li>
                        <li id="undelete_cell" class="disabled" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-disabled="true" class="menu-shortcut-container"><span class="action">Undo Delete Cells</span><span class="kb"><kbd>Z</kbd></span></a></li>
                        <li class="divider" role="none"></li>
                        <li id="split_cell" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Split Cell</span><span class="kb"><kbd>Ctrl-Shift-Minus</kbd></span></a></li>
                        <li id="merge_cell_above" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Merge Cell Above</a></li>
                        <li id="merge_cell_below" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Merge Cell Below</a></li>
                        <li class="divider" role="none"></li>
                        <li id="move_cell_up" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Move Cell Up</a></li>
                        <li id="move_cell_down" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Move Cell Down</a></li>
                        <li class="divider" role="none"></li>
                        <li id="edit_nb_metadata" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Edit Notebook Metadata</a></li>
                        <li class="divider" role="none"></li>
                        <li id="find_and_replace" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem"> Find and Replace </a></li>
                        <li class="divider" role="none"></li>
                        <li id="cut_cell_attachments" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-disabled="true">Paste Cell Attachments</a></li>
                        <li class="divider" role="none"></li>
                        <li id="insert_image" class="disabled" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-disabled="true">  Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" id="viewlink" data-toggle="dropdown" aria-haspopup="true" aria-controls="view_menu">View</a>
                    <ul id="view_menu" class="dropdown-menu" role="menu" aria-labelledby="viewlink">
                        <li id="toggle_header" role="none" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" role="none" title="Show/Hide the action icons (below menu bar)">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" role="none" title="Show/Hide line numbers in cells">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Toggle Line Numbers</span><span class="kb"><kbd>Shift-L</kbd></span></a>
                        </li>
                        <li id="menu-cell-toolbar" class="menu_focus_highlight dropdown-submenu" role="none">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">None</a></li><li data-name="Edit%20Metadata"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Slideshow</a></li><li data-name="Attachments"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Attachments</a></li><li data-name="Tags"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" id="insertlink" data-toggle="dropdown" aria-haspopup="true" aria-controls="insert_menu">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu" role="menu" aria-labelledby="insertlink">
                        <li id="insert_cell_above" role="none" title="Insert an empty Code cell above the currently active cell">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Insert Cell Above</span><span class="kb"><kbd>A</kbd></span></a></li>
                        <li id="insert_cell_below" role="none" title="Insert an empty Code cell below the currently active cell">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Insert Cell Below</span><span class="kb"><kbd>B</kbd></span></a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" id="celllink" data-toggle="dropdown" aria-haspopup="true" aria-controls="cell_menu">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu" role="menu" aria-labelledby="celllink">
                        <li id="run_cell" role="none" title="Run this cell, and move cursor to the next one">
                            <a role="menuitem" href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Run Cells</span><span class="kb"><kbd>Ctrl-Enter</kbd></span></a></li>
                        <li id="run_cell_select_below" role="none" title="Run this cell, select below">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Run Cells and Select Below</span><span class="kb"><kbd>Shift-Enter</kbd></span></a></li>
                        <li id="run_cell_insert_below" role="none" title="Run this cell, insert below">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" class="menu-shortcut-container"><span class="action">Run Cells and Insert Below</span><span class="kb"><kbd>Alt-Enter</kbd></span></a></li>
                        <li id="run_all_cells" role="none" title="Run all cells in the notebook">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Run All</a></li>
                        <li id="run_all_cells_above" role="none" title="Run all cells above (but not including) this cell">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Run All Above</a></li>
                        <li id="run_all_cells_below" role="none" title="Run this cell and all cells below it">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem">Run All Below</a></li>
                        <li class="divider" role="none"></li>
                        <li id="change_cell_type" class="menu_focus_highlight dropdown-submenu" role="none" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Cell Type</a>
                            <ul class="dropdown-menu" role="menu">
                              <li id="to_code" role="none" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Code</span><span class="kb"><kbd>Y</kbd></span></a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Markdown</span><span class="kb"><kbd>M</kbd></span></a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Raw NBConvert</span><span class="kb"><kbd>R</kbd></span></a></li>
                            </ul>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="current_outputs" class="menu_focus_highlight dropdown-submenu" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Current Outputs</a>
                            <ul class="dropdown-menu" role="menu">
                                <li id="toggle_current_output" role="none" title="Hide/Show the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Toggle</span><span class="kb"><kbd>O</kbd></span></a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Toggle Scrolling</span><span class="kb"><kbd>Shift-O</kbd></span></a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="menu_focus_highlight dropdown-submenu" role="none"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">All Output</a>
                            <ul class="dropdown-menu" role="menu">
                                <li id="toggle_all_output" role="none" title="Hide/Show the output of all cells">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" data-toggle="dropdown" id="kernellink" aria-expanded="false">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu" aria-labelledby="kernellink">
                        <li id="int_kernel" title="Send Keyboard Interrupt (CTRL-C) to the Kernel">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Interrupt</span><span class="kb"><kbd>I</kbd>,<kbd>I</kbd></span></a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Restart</span><span class="kb"><kbd>0</kbd>,<kbd>0</kbd></span></a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Shutdown</a>
                        </li>
                        <li class="divider" role="none"></li>
                        <li id="menu-change-kernel" class="menu_focus_highlight dropdown-submenu" role="menuitem">
                            <a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="menuitem" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python3"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Python 3</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" class="menu-shortcut-container"><span class="action">Keyboard Shortcuts</span><span class="kb"><kbd>H</kbd></span></a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

						
                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.jupyter.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="https://docs.python.org/3.7?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://ipython.org/documentation.html?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://docs.scipy.org/doc/numpy/reference/?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://docs.scipy.org/doc/scipy/reference/?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://matplotlib.org/contents.html?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy Reference</span></a></li><li><a target="_blank" title="Opens in a new window" href="https://pandas.pydata.org/pandas-docs/stable/?v=20210305151052"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas Reference</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" aria-label="Run" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-play fa"></i><span class="toolbar-btn-label">Run</span></button><button class="btn btn-default" title="interrupt the kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button><button class="btn btn-default" title="restart the kernel, then re-run the whole notebook (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel-and-run-all-cells"><i class="fa-forward fa"></i></button></div><select id="cell_type" aria-label="combobox, select cell type" role="combobox" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group" id="cmd_palette"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="display: block; height: 587.2px;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[2]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 190.4px; left: 242.65px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 307.238px; margin-bottom: -17px; border-right-width: 33px; min-height: 213px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 242.65px; top: 184.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow</span> <span class="cm-keyword">as</span> <span class="cm-variable">tf</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">assert</span> <span class="cm-variable">tf</span>.<span class="cm-property">__version__</span>.<span class="cm-property">startswith</span>(<span class="cm-string">'2'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">random</span>.<span class="cm-property">set_seed</span>(<span class="cm-number">1234</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">!</span><span class="cm-variable">pip</span> <span class="cm-variable">install</span> <span class="cm-variable">tensorflow</span><span class="cm-operator">-</span><span class="cm-variable">datasets</span><span class="cm-operator">==</span><span class="cm-number">1.2.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow_datasets</span> <span class="cm-keyword">as</span> <span class="cm-variable">tfds</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">re</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 213px;"></div><div class="CodeMirror-gutters" style="display: none; height: 246px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Requirement already satisfied: tensorflow-datasets==1.2.0 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (1.2.0)
Requirement already satisfied: psutil in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (5.8.0)
Requirement already satisfied: tqdm in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (4.58.0)
Requirement already satisfied: future in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (0.18.2)
Requirement already satisfied: promise in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (2.3)
Requirement already satisfied: tensorflow-metadata in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (0.28.0)
Requirement already satisfied: six in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (1.15.0)
Requirement already satisfied: dill in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (0.3.3)
Requirement already satisfied: protobuf&gt;=3.6.1 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (3.14.0)
Requirement already satisfied: wrapt in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (1.12.1)
Requirement already satisfied: termcolor in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (1.1.0)
Requirement already satisfied: absl-py in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (0.10.0)
Requirement already satisfied: requests&gt;=2.19.0 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (2.25.1)
Requirement already satisfied: attrs in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (20.3.0)
Requirement already satisfied: numpy in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-datasets==1.2.0) (1.19.2)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from requests&gt;=2.19.0-&gt;tensorflow-datasets==1.2.0) (2.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from requests&gt;=2.19.0-&gt;tensorflow-datasets==1.2.0) (2020.12.5)
Requirement already satisfied: chardet&lt;5,&gt;=3.0.2 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from requests&gt;=2.19.0-&gt;tensorflow-datasets==1.2.0) (3.0.4)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from requests&gt;=2.19.0-&gt;tensorflow-datasets==1.2.0) (1.26.3)
Requirement already satisfied: googleapis-common-protos&lt;2,&gt;=1.52.0 in c:\users\gaura\anaconda3\envs\chatbot1\lib\site-packages (from tensorflow-metadata-&gt;tensorflow-datasets==1.2.0) (1.53.0)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[3]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 190.4px; left: 535.125px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 622.8px; margin-bottom: -17px; border-right-width: 33px; min-height: 213px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 535.125px; top: 184.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">path_to_zip</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">get_file</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-string">'cornell_movie_dialogs.zip'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">origin</span><span class="cm-operator">=</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-string">'http://www.cs.cornell.edu/~cristian/data/cornell_movie_dialogs_corpus.zip'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">extract</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">path_to_dataset</span> <span class="cm-operator">=</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">dirname</span>(<span class="cm-variable">path_to_zip</span>), <span class="cm-string">"cornell movie-dialogs corpus"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">path_to_movie_lines</span> <span class="cm-operator">=</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">path_to_dataset</span>, <span class="cm-string">'movie_lines.txt'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">path_to_movie_conversations</span> <span class="cm-operator">=</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">path_to_dataset</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                                           <span class="cm-string">'movie_conversations.txt'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 213px;"></div><div class="CodeMirror-gutters" style="display: none; height: 246px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[4]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 677.601px; left: 319.637px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 568.913px; margin-bottom: -17px; border-right-width: 33px; min-height: 700px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 319.637px; top: 672px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Maximum number of samples to preprocess</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">MAX_SAMPLES</span> <span class="cm-operator">=</span> <span class="cm-number">50000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">preprocess_sentence</span>(<span class="cm-variable">sentence</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">sentence</span>.<span class="cm-property">lower</span>().<span class="cm-property">strip</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># creating a space between a word and the punctuation following it</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># eg: "he is a boy." =&gt; "he is a boy ."</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">re</span>.<span class="cm-property">sub</span>(<span class="cm-string">r"([?.!,])"</span>, <span class="cm-string">r" \1 "</span>, <span class="cm-variable">sentence</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">re</span>.<span class="cm-property">sub</span>(<span class="cm-string">r'[" "]+'</span>, <span class="cm-string">" "</span>, <span class="cm-variable">sentence</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># replacing everything with space except (a-z, A-Z, ".", "?", "!", ",")</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">re</span>.<span class="cm-property">sub</span>(<span class="cm-string">r"[^a-zA-Z?.!,]+"</span>, <span class="cm-string">" "</span>, <span class="cm-variable">sentence</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">sentence</span>.<span class="cm-property">strip</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># adding a start and an end token to the sentence</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">sentence</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">load_conversations</span>():</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># dictionary of line id to text</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">id2line</span> <span class="cm-operator">=</span> {}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">path_to_movie_lines</span>, <span class="cm-variable">errors</span><span class="cm-operator">=</span><span class="cm-string">'ignore'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">file</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">lines</span> <span class="cm-operator">=</span> <span class="cm-variable">file</span>.<span class="cm-property">readlines</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">lines</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">parts</span> <span class="cm-operator">=</span> <span class="cm-variable">line</span>.<span class="cm-property">replace</span>(<span class="cm-string">'\n'</span>, <span class="cm-string">''</span>).<span class="cm-property">split</span>(<span class="cm-string">' +++$+++ '</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">id2line</span>[<span class="cm-variable">parts</span>[<span class="cm-number">0</span>]] <span class="cm-operator">=</span> <span class="cm-variable">parts</span>[<span class="cm-number">4</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">inputs</span>, <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> [], []</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">with</span> <span class="cm-builtin">open</span>(<span class="cm-variable">path_to_movie_conversations</span>, <span class="cm-string">'r'</span>) <span class="cm-keyword">as</span> <span class="cm-variable">file</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">lines</span> <span class="cm-operator">=</span> <span class="cm-variable">file</span>.<span class="cm-property">readlines</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">lines</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">parts</span> <span class="cm-operator">=</span> <span class="cm-variable">line</span>.<span class="cm-property">replace</span>(<span class="cm-string">'\n'</span>, <span class="cm-string">''</span>).<span class="cm-property">split</span>(<span class="cm-string">' +++$+++ '</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># get conversation in a list of line ID</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">conversation</span> <span class="cm-operator">=</span> [<span class="cm-variable">line</span>[<span class="cm-number">1</span>:<span class="cm-operator">-</span><span class="cm-number">1</span>] <span class="cm-keyword">for</span> <span class="cm-variable">line</span> <span class="cm-keyword">in</span> <span class="cm-variable">parts</span>[<span class="cm-number">3</span>][<span class="cm-number">1</span>:<span class="cm-operator">-</span><span class="cm-number">1</span>].<span class="cm-property">split</span>(<span class="cm-string">', '</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">conversation</span>) <span class="cm-operator">-</span> <span class="cm-number">1</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable cm-error">inputs</span>.<span class="cm-property">append</span>(<span class="cm-variable">preprocess_sentence</span>(<span class="cm-variable">id2line</span>[<span class="cm-variable">conversation</span>[<span class="cm-variable">i</span>]]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">outputs</span>.<span class="cm-property">append</span>(<span class="cm-variable">preprocess_sentence</span>(<span class="cm-variable">id2line</span>[<span class="cm-variable">conversation</span>[<span class="cm-variable">i</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>]]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-keyword cm-error">if</span> <span class="cm-builtin">len</span>(<span class="cm-variable">inputs</span>) <span class="cm-operator">&gt;=</span> <span class="cm-variable">MAX_SAMPLES</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">return</span> <span class="cm-variable">inputs</span>, <span class="cm-variable">outputs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">inputs</span>, <span class="cm-variable">outputs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">questions</span>, <span class="cm-variable">answers</span> <span class="cm-operator">=</span> <span class="cm-variable">load_conversations</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 700px;"></div><div class="CodeMirror-gutters" style="display: none; height: 733px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[5]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.3996px; left: 358.113px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 391.913px; margin-bottom: -17px; border-right-width: 33px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 358.113px; top: 16.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Sample question: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">questions</span>[<span class="cm-number">20</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Sample answer: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">answers</span>[<span class="cm-number">20</span>]))</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Sample question: i really , really , really wanna go , but i can t . not unless my sister goes .
Sample answer: i m workin on it . but she doesn t seem to be goin for him .
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[6]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 140.001px; left: 288.837px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 584.387px; margin-bottom: -17px; border-right-width: 33px; min-height: 162px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 288.837px; top: 134.4px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Build tokenizer using tfds for both questions and answers</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tokenizer</span> <span class="cm-operator">=</span> <span class="cm-variable">tfds</span>.<span class="cm-property">features</span>.<span class="cm-property">text</span>.<span class="cm-property">SubwordTextEncoder</span>.<span class="cm-property">build_from_corpus</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">questions</span> <span class="cm-operator">+</span> <span class="cm-variable">answers</span>, <span class="cm-variable">target_vocab_size</span><span class="cm-operator">=</span><span class="cm-number">2</span><span class="cm-operator">**</span><span class="cm-number">13</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Define start and end token to indicate the start and end of a sentence</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">START_TOKEN</span>, <span class="cm-variable">END_TOKEN</span> <span class="cm-operator">=</span> [<span class="cm-variable">tokenizer</span>.<span class="cm-property">vocab_size</span>], [<span class="cm-variable">tokenizer</span>.<span class="cm-property">vocab_size</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Vocabulary size plus start and end token</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">VOCAB_SIZE</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenizer</span>.<span class="cm-property">vocab_size</span> <span class="cm-operator">+</span> <span class="cm-number">2</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 195px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[7]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 604.462px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 607.462px; margin-bottom: -17px; border-right-width: 33px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 604.462px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Tokenized sample question: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">tokenizer</span>.<span class="cm-property">encode</span>(<span class="cm-variable">questions</span>[<span class="cm-number">20</span>])))</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 61px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Tokenized sample question: [4, 281, 3, 281, 3, 143, 395, 176, 3, 42, 4, 38, 8190, 2, 37, 874, 27, 2030, 3096, 1]
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[8]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 442.401px; left: 465.9px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 538.212px; margin-bottom: -17px; border-right-width: 33px; min-height: 465px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 465.9px; top: 436.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Maximum sentence length</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">MAX_LENGTH</span> <span class="cm-operator">=</span> <span class="cm-number">40</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Tokenize, filter and pad sentences</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">tokenize_and_filter</span>(<span class="cm-variable">inputs</span>, <span class="cm-variable">outputs</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">tokenized_inputs</span>, <span class="cm-variable">tokenized_outputs</span> <span class="cm-operator">=</span> [], []</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">for</span> (<span class="cm-variable">sentence1</span>, <span class="cm-variable">sentence2</span>) <span class="cm-keyword">in</span> <span class="cm-builtin">zip</span>(<span class="cm-variable">inputs</span>, <span class="cm-variable">outputs</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># tokenize sentence</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sentence1</span> <span class="cm-operator">=</span> <span class="cm-variable">START_TOKEN</span> <span class="cm-operator">+</span> <span class="cm-variable">tokenizer</span>.<span class="cm-property">encode</span>(<span class="cm-variable">sentence1</span>) <span class="cm-operator">+</span> <span class="cm-variable">END_TOKEN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sentence2</span> <span class="cm-operator">=</span> <span class="cm-variable">START_TOKEN</span> <span class="cm-operator">+</span> <span class="cm-variable">tokenizer</span>.<span class="cm-property">encode</span>(<span class="cm-variable">sentence2</span>) <span class="cm-operator">+</span> <span class="cm-variable">END_TOKEN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># check tokenized sentence max length</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-builtin">len</span>(<span class="cm-variable">sentence1</span>) <span class="cm-operator">&lt;=</span> <span class="cm-variable">MAX_LENGTH</span> <span class="cm-keyword">and</span> <span class="cm-builtin">len</span>(<span class="cm-variable">sentence2</span>) <span class="cm-operator">&lt;=</span> <span class="cm-variable">MAX_LENGTH</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable cm-error">tokenized_inputs</span>.<span class="cm-property">append</span>(<span class="cm-variable">sentence1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">tokenized_outputs</span>.<span class="cm-property">append</span>(<span class="cm-variable">sentence2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-null cm-error">  </span><span class="cm-comment"># pad tokenized sentences</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">tokenized_inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">preprocessing</span>.<span class="cm-property">sequence</span>.<span class="cm-property">pad_sequences</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">tokenized_inputs</span>, <span class="cm-variable">maxlen</span><span class="cm-operator">=</span><span class="cm-variable">MAX_LENGTH</span>, <span class="cm-variable">padding</span><span class="cm-operator">=</span><span class="cm-string">'post'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">tokenized_outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">preprocessing</span>.<span class="cm-property">sequence</span>.<span class="cm-property">pad_sequences</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">tokenized_outputs</span>, <span class="cm-variable">maxlen</span><span class="cm-operator">=</span><span class="cm-variable">MAX_LENGTH</span>, <span class="cm-variable">padding</span><span class="cm-operator">=</span><span class="cm-string">'post'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-null cm-error">  </span><span class="cm-keyword">return</span> <span class="cm-variable">tokenized_inputs</span>, <span class="cm-variable">tokenized_outputs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">questions</span>, <span class="cm-variable">answers</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenize_and_filter</span>(<span class="cm-variable">questions</span>, <span class="cm-variable">answers</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 465px;"></div><div class="CodeMirror-gutters" style="display: none; height: 498px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[9]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.3996px; left: 412px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 415px; margin-bottom: -17px; border-right-width: 33px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 412px; top: 16.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Vocab size: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">VOCAB_SIZE</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Number of samples: {}'</span>.<span class="cm-property">format</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">questions</span>)))</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Vocab size: 8332
Number of samples: 44098
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[12]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 257.601px; left: 196.462px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 445.825px; margin-bottom: -17px; border-right-width: 33px; min-height: 330px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 196.462px; top: 252px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BATCH_SIZE</span> <span class="cm-operator">=</span> <span class="cm-number">64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BUFFER_SIZE</span> <span class="cm-operator">=</span> <span class="cm-number">20000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># decoder inputs use the previous target as input</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># remove START_TOKEN from targets</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">data</span>.<span class="cm-property">Dataset</span>.<span class="cm-property">from_tensor_slices</span>((</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-string">'inputs'</span>: <span class="cm-variable">questions</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-string">'dec_inputs'</span>: <span class="cm-variable">answers</span>[:, :<span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-string">'outputs'</span>: <span class="cm-variable">answers</span>[:, <span class="cm-number">1</span>:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> <span class="cm-operator">=</span> <span class="cm-variable">dataset</span>.<span class="cm-property">cache</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> <span class="cm-operator">=</span> <span class="cm-variable">dataset</span>.<span class="cm-property">shuffle</span>(<span class="cm-variable">BUFFER_SIZE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> <span class="cm-operator">=</span> <span class="cm-variable">dataset</span>.<span class="cm-property">batch</span>(<span class="cm-variable">BATCH_SIZE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> <span class="cm-operator">=</span> <span class="cm-variable">dataset</span>.<span class="cm-property">prefetch</span>(<span class="cm-variable">tf</span>.<span class="cm-property">data</span>.<span class="cm-property">experimental</span>.<span class="cm-property">AUTOTUNE</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 330px;"></div><div class="CodeMirror-gutters" style="display: none; height: 363px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[13]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 111.775px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 114.775px; margin-bottom: -17px; border-right-width: 33px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 111.775px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">dataset</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 61px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>&lt;PrefetchDataset shapes: ({inputs: (None, 40), dec_inputs: (None, 39)}, {outputs: (None, 39)}), types: ({inputs: tf.int32, dec_inputs: tf.int32}, {outputs: tf.int32})&gt;
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[14]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 291.201px; left: 119.475px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 453.5px; margin-bottom: -17px; border-right-width: 33px; min-height: 314px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 119.475px; top: 285.6px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">scaled_dot_product_attention</span>(<span class="cm-variable">query</span>, <span class="cm-variable">key</span>, <span class="cm-variable">value</span>, <span class="cm-variable">mask</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-string cm-error">"""Calculate the attention weights. """</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">matmul_qk</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">matmul</span>(<span class="cm-variable">query</span>, <span class="cm-variable">key</span>, <span class="cm-variable">transpose_b</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># scale matmul_qk</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">depth</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">tf</span>.<span class="cm-property">shape</span>(<span class="cm-variable">key</span>)[<span class="cm-operator">-</span><span class="cm-number">1</span>], <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">logits</span> <span class="cm-operator">=</span> <span class="cm-variable">matmul_qk</span> <span class="cm-operator">/</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">sqrt</span>(<span class="cm-variable">depth</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># add the mask to zero out padding tokens</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">if</span> <span class="cm-variable">mask</span> <span class="cm-keyword">is</span> <span class="cm-keyword">not</span> <span class="cm-keyword">None</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">logits</span> <span class="cm-operator">+=</span> (<span class="cm-variable">mask</span> <span class="cm-operator">*</span> <span class="cm-operator">-</span><span class="cm-number">1e9</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># softmax is normalized on the last axis (seq_len_k)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">attention_weights</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">nn</span>.<span class="cm-property">softmax</span>(<span class="cm-variable">logits</span>, <span class="cm-variable">axis</span><span class="cm-operator">=-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">output</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">matmul</span>(<span class="cm-variable">attention_weights</span>, <span class="cm-variable">value</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">output</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 314px;"></div><div class="CodeMirror-gutters" style="display: none; height: 347px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[15]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 828.8px; left: 142.575px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 592.063px; margin-bottom: -17px; border-right-width: 33px; min-height: 851px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 142.575px; top: 823.2px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">MultiHeadAttention</span>(<span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Layer</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">d_model</span>, <span class="cm-variable">num_heads</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"multi_head_attention"</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-builtin">super</span>(<span class="cm-variable">MultiHeadAttention</span>, <span class="cm-variable-2">self</span>).<span class="cm-property">__init__</span>(<span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-variable">name</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">num_heads</span> <span class="cm-operator">=</span> <span class="cm-variable">num_heads</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">d_model</span> <span class="cm-operator">=</span> <span class="cm-variable">d_model</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">assert</span> <span class="cm-variable">d_model</span> <span class="cm-operator">%</span> <span class="cm-variable-2">self</span>.<span class="cm-property">num_heads</span> <span class="cm-operator">==</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">depth</span> <span class="cm-operator">=</span> <span class="cm-variable">d_model</span> <span class="cm-operator">//</span> <span class="cm-variable-2">self</span>.<span class="cm-property">num_heads</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">query_dense</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">key_dense</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">value_dense</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">dense</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">def</span> <span class="cm-def">split_heads</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">inputs</span>, <span class="cm-variable">batch_size</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">reshape</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">inputs</span>, <span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-variable">batch_size</span>, <span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">num_heads</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">depth</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">transpose</span>(<span class="cm-variable">inputs</span>, <span class="cm-variable">perm</span><span class="cm-operator">=</span>[<span class="cm-number">0</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>, <span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">def</span> <span class="cm-def">call</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">inputs</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">query</span>, <span class="cm-variable">key</span>, <span class="cm-variable">value</span>, <span class="cm-variable">mask</span> <span class="cm-operator">=</span> <span class="cm-variable">inputs</span>[<span class="cm-string">'query'</span>], <span class="cm-variable">inputs</span>[<span class="cm-string">'key'</span>], <span class="cm-variable">inputs</span>[</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-string">'value'</span>], <span class="cm-variable">inputs</span>[<span class="cm-string">'mask'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">batch_size</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">shape</span>(<span class="cm-variable">query</span>)[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># linear layers</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">query</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">query_dense</span>(<span class="cm-variable">query</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">key</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">key_dense</span>(<span class="cm-variable">key</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">value_dense</span>(<span class="cm-variable">value</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># split heads</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">query</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">split_heads</span>(<span class="cm-variable">query</span>, <span class="cm-variable">batch_size</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">key</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">split_heads</span>(<span class="cm-variable">key</span>, <span class="cm-variable">batch_size</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">split_heads</span>(<span class="cm-variable">value</span>, <span class="cm-variable">batch_size</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># scaled dot-product attention</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">scaled_attention</span> <span class="cm-operator">=</span> <span class="cm-variable">scaled_dot_product_attention</span>(<span class="cm-variable">query</span>, <span class="cm-variable">key</span>, <span class="cm-variable">value</span>, <span class="cm-variable">mask</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">scaled_attention</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">transpose</span>(<span class="cm-variable">scaled_attention</span>, <span class="cm-variable">perm</span><span class="cm-operator">=</span>[<span class="cm-number">0</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>, <span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># concatenation of heads</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">concat_attention</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">reshape</span>(<span class="cm-variable">scaled_attention</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                                  (<span class="cm-variable">batch_size</span>, <span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">d_model</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># final linear layer</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">dense</span>(<span class="cm-variable">concat_attention</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">outputs</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 851px;"></div><div class="CodeMirror-gutters" style="display: none; height: 884px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[16]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.0001px; left: 335.063px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 384.275px; margin-bottom: -17px; border-right-width: 33px; min-height: 78px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 335.063px; top: 50.4px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">create_padding_mask</span>(<span class="cm-variable">x</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">equal</span>(<span class="cm-variable">x</span>, <span class="cm-number">0</span>), <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># (batch_size, 1, 1, sequence length)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">mask</span>[:, <span class="cm-variable">tf</span>.<span class="cm-property">newaxis</span>, <span class="cm-variable">tf</span>.<span class="cm-property">newaxis</span>, :]</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 111px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[17]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 581.413px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 584.425px; margin-bottom: -17px; border-right-width: 33px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 581.413px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">create_padding_mask</span>(<span class="cm-variable">tf</span>.<span class="cm-property">constant</span>([[<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">0</span>, <span class="cm-number">3</span>, <span class="cm-number">0</span>], [<span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">4</span>, <span class="cm-number">5</span>]])))</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 61px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>tf.Tensor(
[[[[0. 0. 1. 0. 1.]]]


 [[[1. 1. 1. 0. 0.]]]], shape=(2, 1, 1, 5), dtype=float32)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[18]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 72.8001px; left: 388.913px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 615.212px; margin-bottom: -17px; border-right-width: 33px; min-height: 95px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 388.913px; top: 67.2px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">create_look_ahead_mask</span>(<span class="cm-variable">x</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">seq_len</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">shape</span>(<span class="cm-variable">x</span>)[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">look_ahead_mask</span> <span class="cm-operator">=</span> <span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-variable">tf</span>.<span class="cm-property">linalg</span>.<span class="cm-property">band_part</span>(<span class="cm-variable">tf</span>.<span class="cm-property">ones</span>((<span class="cm-variable">seq_len</span>, <span class="cm-variable">seq_len</span>)), <span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">create_padding_mask</span>(<span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">maximum</span>(<span class="cm-variable">look_ahead_mask</span>, <span class="cm-variable">padding_mask</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 95px;"></div><div class="CodeMirror-gutters" style="display: none; height: 128px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[19]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 473.613px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 476.625px; margin-bottom: -17px; border-right-width: 33px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 473.613px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">create_look_ahead_mask</span>(<span class="cm-variable">tf</span>.<span class="cm-property">constant</span>([[<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">0</span>, <span class="cm-number">4</span>, <span class="cm-number">5</span>]])))</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 61px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>tf.Tensor(
[[[[0. 1. 1. 1. 1.]
   [0. 0. 1. 1. 1.]
   [0. 0. 1. 1. 1.]
   [0. 0. 1. 0. 1.]
   [0. 0. 1. 0. 0.]]]], shape=(1, 1, 5, 5), dtype=float32)
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[20]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 425.6px; left: 504.4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 599.85px; margin-bottom: -17px; border-right-width: 33px; min-height: 448px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 504.4px; top: 420px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">PositionalEncoding</span>(<span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Layer</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">position</span>, <span class="cm-variable">d_model</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-builtin">super</span>(<span class="cm-variable">PositionalEncoding</span>, <span class="cm-variable-2">self</span>).<span class="cm-property">__init__</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">pos_encoding</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">positional_encoding</span>(<span class="cm-variable">position</span>, <span class="cm-variable">d_model</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">def</span> <span class="cm-def">get_angles</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">position</span>, <span class="cm-variable">i</span>, <span class="cm-variable">d_model</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">angles</span> <span class="cm-operator">=</span> <span class="cm-number">1</span> <span class="cm-operator">/</span> <span class="cm-variable">tf</span>.<span class="cm-property">pow</span>(<span class="cm-number">10000</span>, (<span class="cm-number">2</span> <span class="cm-operator">*</span> (<span class="cm-variable">i</span> <span class="cm-operator">//</span> <span class="cm-number">2</span>)) <span class="cm-operator">/</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">d_model</span>, <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">position</span> <span class="cm-operator">*</span> <span class="cm-variable">angles</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">def</span> <span class="cm-def">positional_encoding</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">position</span>, <span class="cm-variable">d_model</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">angle_rads</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">get_angles</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">position</span><span class="cm-operator">=</span><span class="cm-variable">tf</span>.<span class="cm-property">range</span>(<span class="cm-variable">position</span>, <span class="cm-variable">dtype</span><span class="cm-operator">=</span><span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)[:, <span class="cm-variable">tf</span>.<span class="cm-property">newaxis</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">i</span><span class="cm-operator">=</span><span class="cm-variable">tf</span>.<span class="cm-property">range</span>(<span class="cm-variable">d_model</span>, <span class="cm-variable">dtype</span><span class="cm-operator">=</span><span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)[<span class="cm-variable">tf</span>.<span class="cm-property">newaxis</span>, :],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># apply sin to even index in the array</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sines</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">sin</span>(<span class="cm-variable">angle_rads</span>[:, <span class="cm-number">0</span>::<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># apply cos to odd index in the array</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">cosines</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">cos</span>(<span class="cm-variable">angle_rads</span>[:, <span class="cm-number">1</span>::<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">pos_encoding</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">concat</span>([<span class="cm-variable">sines</span>, <span class="cm-variable">cosines</span>], <span class="cm-variable">axis</span><span class="cm-operator">=-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">pos_encoding</span> <span class="cm-operator">=</span> <span class="cm-variable">pos_encoding</span>[<span class="cm-variable">tf</span>.<span class="cm-property">newaxis</span>, <span class="cm-operator">...</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">pos_encoding</span>, <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">def</span> <span class="cm-def">call</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">inputs</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">inputs</span> <span class="cm-operator">+</span> <span class="cm-variable-2">self</span>.<span class="cm-property">pos_encoding</span>[:, :<span class="cm-variable">tf</span>.<span class="cm-property">shape</span>(<span class="cm-variable">inputs</span>)[<span class="cm-number">1</span>], :]</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 448px;"></div><div class="CodeMirror-gutters" style="display: none; height: 481px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[21]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 123.2px; left: 81px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 561.275px; margin-bottom: -17px; border-right-width: 33px; min-height: 146px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 81px; top: 117.6px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_pos_encoding</span> <span class="cm-operator">=</span> <span class="cm-variable">PositionalEncoding</span>(<span class="cm-number">50</span>, <span class="cm-number">512</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">pcolormesh</span>(<span class="cm-variable">sample_pos_encoding</span>.<span class="cm-property">pos_encoding</span>.<span class="cm-property">numpy</span>()[<span class="cm-number">0</span>], <span class="cm-variable">cmap</span><span class="cm-operator">=</span><span class="cm-string">'RdBu'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">'Depth'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlim</span>((<span class="cm-number">0</span>, <span class="cm-number">512</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">'Position'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">colorbar</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 146px;"></div><div class="CodeMirror-gutters" style="display: none; height: 179px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_png" dir="auto"><img src="data:image/png;base64,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"></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[22]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 375.2px; left: 496.712px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 592.087px; margin-bottom: -17px; border-right-width: 33px; min-height: 398px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 496.712px; top: 369.6px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">encoder_layer</span>(<span class="cm-variable">units</span>, <span class="cm-variable">d_model</span>, <span class="cm-variable">num_heads</span>, <span class="cm-variable">dropout</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"encoder_layer"</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>, <span class="cm-variable">d_model</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"inputs"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-keyword">None</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"padding_mask"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">attention</span> <span class="cm-operator">=</span> <span class="cm-variable">MultiHeadAttention</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">d_model</span>, <span class="cm-variable">num_heads</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"attention"</span>)({</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'query'</span>: <span class="cm-variable">inputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'key'</span>: <span class="cm-variable">inputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'value'</span>: <span class="cm-variable">inputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'mask'</span>: <span class="cm-variable">padding_mask</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">attention</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dropout</span>(<span class="cm-variable">rate</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>)(<span class="cm-variable">attention</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">attention</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">LayerNormalization</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">epsilon</span><span class="cm-operator">=</span><span class="cm-number">1e-6</span>)(<span class="cm-variable">inputs</span> <span class="cm-operator">+</span> <span class="cm-variable">attention</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">units</span>, <span class="cm-variable">activation</span><span class="cm-operator">=</span><span class="cm-string">'relu'</span>)(<span class="cm-variable">attention</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)(<span class="cm-variable">outputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dropout</span>(<span class="cm-variable">rate</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>)(<span class="cm-variable">outputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">LayerNormalization</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">epsilon</span><span class="cm-operator">=</span><span class="cm-number">1e-6</span>)(<span class="cm-variable">attention</span> <span class="cm-operator">+</span> <span class="cm-variable">outputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">inputs</span>, <span class="cm-variable">padding_mask</span>], <span class="cm-variable">outputs</span><span class="cm-operator">=</span><span class="cm-variable">outputs</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-variable">name</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 398px;"></div><div class="CodeMirror-gutters" style="display: none; height: 431px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[28]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.3996px; left: 111.788px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 561.262px; margin-bottom: -17px; border-right-width: 33px; min-height: 162px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 111.788px; top: 16.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_encoder_layer</span> <span class="cm-operator">=</span> <span class="cm-variable">encoder_layer</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-number">512</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-number">128</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-number">4</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-number">0.3</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"sample_encoder_layer"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">plot_model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sample_encoder_layer</span>, <span class="cm-variable">to_file</span><span class="cm-operator">=</span><span class="cm-string">'encoder_layer.png'</span>, <span class="cm-variable">show_shapes</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 195px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>('Failed to import pydot. You must `pip install pydot` and install graphviz (https://graphviz.gitlab.io/download/), ', 'for `pydotprint` to work.')
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[29]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 442.4px; left: 496.712px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 561.3px; margin-bottom: -17px; border-right-width: 33px; min-height: 465px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 496.712px; top: 436.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">encoder</span>(<span class="cm-variable">vocab_size</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">num_layers</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"encoder"</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>,), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"inputs"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-keyword">None</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"padding_mask"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">embeddings</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Embedding</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">d_model</span>)(<span class="cm-variable">inputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">embeddings</span> <span class="cm-operator">*=</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">sqrt</span>(<span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">d_model</span>, <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">embeddings</span> <span class="cm-operator">=</span> <span class="cm-variable">PositionalEncoding</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">d_model</span>)(<span class="cm-variable">embeddings</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dropout</span>(<span class="cm-variable">rate</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>)(<span class="cm-variable">embeddings</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">num_layers</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">encoder_layer</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"encoder_layer_{}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    )([<span class="cm-variable">outputs</span>, <span class="cm-variable">padding_mask</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">inputs</span>, <span class="cm-variable">padding_mask</span>], <span class="cm-variable">outputs</span><span class="cm-operator">=</span><span class="cm-variable">outputs</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-variable">name</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 465px;"></div><div class="CodeMirror-gutters" style="display: none; height: 498px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[30]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 173.6px; left: 458.2px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 461.2px; margin-bottom: -17px; border-right-width: 33px; min-height: 196px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 458.2px; top: 168px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_encoder</span> <span class="cm-operator">=</span> <span class="cm-variable">encoder</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">vocab_size</span><span class="cm-operator">=</span><span class="cm-number">8192</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_layers</span><span class="cm-operator">=</span><span class="cm-number">2</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-number">512</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-number">128</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-number">4</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-number">0.3</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"sample_encoder"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">plot_model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">   <span class="cm-variable">sample_encoder</span>, <span class="cm-variable">to_file</span><span class="cm-operator">=</span><span class="cm-string">'encoder.png'</span>, <span class="cm-variable">show_shapes</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 196px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>('Failed to import pydot. You must `pip install pydot` and install graphviz (https://graphviz.gitlab.io/download/), ', 'for `pydotprint` to work.')
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[31]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 627.2px; left: 127.188px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 599.762px; margin-bottom: -17px; border-right-width: 33px; min-height: 650px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 127.188px; top: 621.6px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">decoder_layer</span>(<span class="cm-variable">units</span>, <span class="cm-variable">d_model</span>, <span class="cm-variable">num_heads</span>, <span class="cm-variable">dropout</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"decoder_layer"</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>, <span class="cm-variable">d_model</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"inputs"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">enc_outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>, <span class="cm-variable">d_model</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"encoder_outputs"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">look_ahead_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"look_ahead_mask"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-keyword">None</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'padding_mask'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">attention1</span> <span class="cm-operator">=</span> <span class="cm-variable">MultiHeadAttention</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">d_model</span>, <span class="cm-variable">num_heads</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"attention_1"</span>)(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>{</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'query'</span>: <span class="cm-variable">inputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'key'</span>: <span class="cm-variable">inputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'value'</span>: <span class="cm-variable">inputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'mask'</span>: <span class="cm-variable">look_ahead_mask</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">attention1</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">LayerNormalization</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">epsilon</span><span class="cm-operator">=</span><span class="cm-number">1e-6</span>)(<span class="cm-variable">attention1</span> <span class="cm-operator">+</span> <span class="cm-variable">inputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">attention2</span> <span class="cm-operator">=</span> <span class="cm-variable">MultiHeadAttention</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">d_model</span>, <span class="cm-variable">num_heads</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"attention_2"</span>)(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>{</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'query'</span>: <span class="cm-variable">attention1</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'key'</span>: <span class="cm-variable">enc_outputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'value'</span>: <span class="cm-variable">enc_outputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">          <span class="cm-string">'mask'</span>: <span class="cm-variable">padding_mask</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">attention2</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dropout</span>(<span class="cm-variable">rate</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>)(<span class="cm-variable">attention2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">attention2</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">LayerNormalization</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">epsilon</span><span class="cm-operator">=</span><span class="cm-number">1e-6</span>)(<span class="cm-variable">attention2</span> <span class="cm-operator">+</span> <span class="cm-variable">attention1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">units</span>, <span class="cm-variable">activation</span><span class="cm-operator">=</span><span class="cm-string">'relu'</span>)(<span class="cm-variable">attention2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>)(<span class="cm-variable">outputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dropout</span>(<span class="cm-variable">rate</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>)(<span class="cm-variable">outputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">LayerNormalization</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">epsilon</span><span class="cm-operator">=</span><span class="cm-number">1e-6</span>)(<span class="cm-variable">outputs</span> <span class="cm-operator">+</span> <span class="cm-variable">attention2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">inputs</span>, <span class="cm-variable">enc_outputs</span>, <span class="cm-variable">look_ahead_mask</span>, <span class="cm-variable">padding_mask</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">outputs</span><span class="cm-operator">=</span><span class="cm-variable">outputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-variable">name</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 650px;"></div><div class="CodeMirror-gutters" style="display: none; height: 683px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[32]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 140px; left: 558.262px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 561.262px; margin-bottom: -17px; border-right-width: 33px; min-height: 162px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 558.262px; top: 134.4px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_decoder_layer</span> <span class="cm-operator">=</span> <span class="cm-variable">decoder_layer</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-number">512</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-number">128</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-number">4</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-number">0.3</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"sample_decoder_layer"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">plot_model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sample_decoder_layer</span>, <span class="cm-variable">to_file</span><span class="cm-operator">=</span><span class="cm-string">'decoder_layer.png'</span>, <span class="cm-variable">show_shapes</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 195px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>('Failed to import pydot. You must `pip install pydot` and install graphviz (https://graphviz.gitlab.io/download/), ', 'for `pydotprint` to work.')
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[33]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 526.4px; left: 127.188px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 599.788px; margin-bottom: -17px; border-right-width: 33px; min-height: 549px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 127.188px; top: 520.8px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">decoder</span>(<span class="cm-variable">vocab_size</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">num_layers</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'decoder'</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>,), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'inputs'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">enc_outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>, <span class="cm-variable">d_model</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'encoder_outputs'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">look_ahead_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'look_ahead_mask'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-keyword">None</span>), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'padding_mask'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-null cm-error">  </span><span class="cm-variable">embeddings</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Embedding</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">d_model</span>)(<span class="cm-variable">inputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">embeddings</span> <span class="cm-operator">*=</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">sqrt</span>(<span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">d_model</span>, <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">embeddings</span> <span class="cm-operator">=</span> <span class="cm-variable">PositionalEncoding</span>(<span class="cm-variable">vocab_size</span>, <span class="cm-variable">d_model</span>)(<span class="cm-variable">embeddings</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dropout</span>(<span class="cm-variable">rate</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>)(<span class="cm-variable">embeddings</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">num_layers</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">decoder_layer</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'decoder_layer_{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    )(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">outputs</span>, <span class="cm-variable">enc_outputs</span>, <span class="cm-variable">look_ahead_mask</span>, <span class="cm-variable">padding_mask</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">inputs</span>, <span class="cm-variable">enc_outputs</span>, <span class="cm-variable">look_ahead_mask</span>, <span class="cm-variable">padding_mask</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">outputs</span><span class="cm-operator">=</span><span class="cm-variable">outputs</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-variable">name</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 549px;"></div><div class="CodeMirror-gutters" style="display: none; height: 582px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[34]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 173.6px; left: 465.9px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 468.9px; margin-bottom: -17px; border-right-width: 33px; min-height: 196px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 465.9px; top: 168px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_decoder</span> <span class="cm-operator">=</span> <span class="cm-variable">decoder</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">vocab_size</span><span class="cm-operator">=</span><span class="cm-number">8192</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_layers</span><span class="cm-operator">=</span><span class="cm-number">2</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-number">512</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-number">128</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-number">4</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-number">0.3</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"sample_decoder"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">plot_model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sample_decoder</span>, <span class="cm-variable">to_file</span><span class="cm-operator">=</span><span class="cm-string">'decoder.png'</span>, <span class="cm-variable">show_shapes</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 196px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>('Failed to import pydot. You must `pip install pydot` and install graphviz (https://graphviz.gitlab.io/download/), ', 'for `pydotprint` to work.')
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[35]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 728px; left: 619.887px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 622.875px; margin-bottom: -17px; border-right-width: 33px; min-height: 750px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 619.887px; top: 722.4px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">transformer</span>(<span class="cm-variable">vocab_size</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                <span class="cm-variable">num_layers</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                <span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                <span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                <span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                <span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"transformer"</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>,), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"inputs"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">dec_inputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Input</span>(<span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-keyword">None</span>,), <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"dec_inputs"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">enc_padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Lambda</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">create_padding_mask</span>, <span class="cm-variable">output_shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-keyword">None</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'enc_padding_mask'</span>)(<span class="cm-variable">inputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># mask the future tokens for decoder inputs at the 1st attention block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">look_ahead_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Lambda</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">create_look_ahead_mask</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">output_shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-keyword">None</span>, <span class="cm-keyword">None</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'look_ahead_mask'</span>)(<span class="cm-variable">dec_inputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># mask the encoder outputs for the 2nd attention block</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">dec_padding_mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Lambda</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">create_padding_mask</span>, <span class="cm-variable">output_shape</span><span class="cm-operator">=</span>(<span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-keyword">None</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">'dec_padding_mask'</span>)(<span class="cm-variable">inputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">enc_outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">encoder</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">vocab_size</span><span class="cm-operator">=</span><span class="cm-variable">vocab_size</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">num_layers</span><span class="cm-operator">=</span><span class="cm-variable">num_layers</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  )(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">inputs</span>, <span class="cm-variable">enc_padding_mask</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">dec_outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">decoder</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">vocab_size</span><span class="cm-operator">=</span><span class="cm-variable">vocab_size</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">num_layers</span><span class="cm-operator">=</span><span class="cm-variable">num_layers</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">units</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-variable">d_model</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-variable">num_heads</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-variable">dropout</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  )(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">dec_inputs</span>, <span class="cm-variable">enc_outputs</span>, <span class="cm-variable">look_ahead_mask</span>, <span class="cm-variable">dec_padding_mask</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">outputs</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">layers</span>.<span class="cm-property">Dense</span>(<span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">vocab_size</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"outputs"</span>)(<span class="cm-variable">dec_outputs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">Model</span>(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">inputs</span>, <span class="cm-variable">dec_inputs</span>], <span class="cm-variable">outputs</span><span class="cm-operator">=</span><span class="cm-variable">outputs</span>, <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-variable">name</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 750px;"></div><div class="CodeMirror-gutters" style="display: none; height: 783px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[36]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 173.6px; left: 527.488px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 530.488px; margin-bottom: -17px; border-right-width: 33px; min-height: 196px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 527.488px; top: 168px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_transformer</span> <span class="cm-operator">=</span> <span class="cm-variable">transformer</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">vocab_size</span><span class="cm-operator">=</span><span class="cm-number">8192</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_layers</span><span class="cm-operator">=</span><span class="cm-number">4</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-number">512</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-number">128</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-number">4</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-number">0.3</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">name</span><span class="cm-operator">=</span><span class="cm-string">"sample_transformer"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">utils</span>.<span class="cm-property">plot_model</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">sample_transformer</span>, <span class="cm-variable">to_file</span><span class="cm-operator">=</span><span class="cm-string">'transformer.png'</span>, <span class="cm-variable">show_shapes</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 196px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>('Failed to import pydot. You must `pip install pydot` and install graphviz (https://graphviz.gitlab.io/download/), ', 'for `pydotprint` to work.')
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[37]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 257.6px; left: 157.975px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 253.35px; margin-bottom: -17px; border-right-width: 33px; min-height: 280px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 157.975px; top: 252px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">backend</span>.<span class="cm-property">clear_session</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Hyper-parameters</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">NUM_LAYERS</span> <span class="cm-operator">=</span> <span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">D_MODEL</span> <span class="cm-operator">=</span> <span class="cm-number">256</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">NUM_HEADS</span> <span class="cm-operator">=</span> <span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">UNITS</span> <span class="cm-operator">=</span> <span class="cm-number">512</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DROPOUT</span> <span class="cm-operator">=</span> <span class="cm-number">0.1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">transformer</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">vocab_size</span><span class="cm-operator">=</span><span class="cm-variable">VOCAB_SIZE</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_layers</span><span class="cm-operator">=</span><span class="cm-variable">NUM_LAYERS</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">units</span><span class="cm-operator">=</span><span class="cm-variable">UNITS</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-variable">D_MODEL</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">num_heads</span><span class="cm-operator">=</span><span class="cm-variable">NUM_HEADS</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">dropout</span><span class="cm-operator">=</span><span class="cm-variable">DROPOUT</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 280px;"></div><div class="CodeMirror-gutters" style="display: none; height: 313px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[38]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 156.8px; left: 227.262px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 445.825px; margin-bottom: -17px; border-right-width: 33px; min-height: 179px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 227.262px; top: 151.2px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">loss_function</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">y_pred</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">y_true</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">reshape</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">MAX_LENGTH</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">loss</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">losses</span>.<span class="cm-property">SparseCategoricalCrossentropy</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">from_logits</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>, <span class="cm-variable">reduction</span><span class="cm-operator">=</span><span class="cm-string">'none'</span>)(<span class="cm-variable">y_true</span>, <span class="cm-variable">y_pred</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">mask</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">tf</span>.<span class="cm-property">not_equal</span>(<span class="cm-variable">y_true</span>, <span class="cm-number">0</span>), <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">loss</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">multiply</span>(<span class="cm-variable">loss</span>, <span class="cm-variable">mask</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">reduce_mean</span>(<span class="cm-variable">loss</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 212px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[39]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 240.8px; left: 527.55px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 568.95px; margin-bottom: -17px; border-right-width: 33px; min-height: 263px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 527.55px; top: 235.2px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">CustomSchedule</span>(<span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">optimizers</span>.<span class="cm-property">schedules</span>.<span class="cm-property">LearningRateSchedule</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">d_model</span>, <span class="cm-variable">warmup_steps</span><span class="cm-operator">=</span><span class="cm-number">4000</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-builtin">super</span>(<span class="cm-variable">CustomSchedule</span>, <span class="cm-variable-2">self</span>).<span class="cm-property">__init__</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">d_model</span> <span class="cm-operator">=</span> <span class="cm-variable">d_model</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">d_model</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">d_model</span>, <span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable-2">self</span>.<span class="cm-property">warmup_steps</span> <span class="cm-operator">=</span> <span class="cm-variable">warmup_steps</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">def</span> <span class="cm-def">__call__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">step</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">arg1</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">rsqrt</span>(<span class="cm-variable">step</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">arg2</span> <span class="cm-operator">=</span> <span class="cm-variable">step</span> <span class="cm-operator">*</span> (<span class="cm-variable-2">self</span>.<span class="cm-property">warmup_steps</span><span class="cm-operator">**-</span><span class="cm-number">1.5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">rsqrt</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">d_model</span>) <span class="cm-operator">*</span> <span class="cm-variable">tf</span>.<span class="cm-property">math</span>.<span class="cm-property">minimum</span>(<span class="cm-variable">arg1</span>, <span class="cm-variable">arg2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 263px;"></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[40]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 72.8px; left: 188.763px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 515.1px; margin-bottom: -17px; border-right-width: 33px; min-height: 95px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 188.763px; top: 67.2px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sample_learning_rate</span> <span class="cm-operator">=</span> <span class="cm-variable">CustomSchedule</span>(<span class="cm-variable">d_model</span><span class="cm-operator">=</span><span class="cm-number">128</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">plot</span>(<span class="cm-variable">sample_learning_rate</span>(<span class="cm-variable">tf</span>.<span class="cm-property">range</span>(<span class="cm-number">200000</span>, <span class="cm-variable">dtype</span><span class="cm-operator">=</span><span class="cm-variable">tf</span>.<span class="cm-property">float32</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">"Learning Rate"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">"Train Step"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 95px;"></div><div class="CodeMirror-gutters" style="display: none; height: 128px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt output_prompt"><bdi>Out[40]:</bdi></div><div class="output_subarea output_text output_result" dir="auto"><pre>Text(0.5, 0, 'Train Step')</pre></div></div><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_png" dir="auto"><img src="data:image/png;base64,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"></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[41]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 173.6px; left: 573.7px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 576.7px; margin-bottom: -17px; border-right-width: 33px; min-height: 196px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 573.7px; top: 168px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">learning_rate</span> <span class="cm-operator">=</span> <span class="cm-variable">CustomSchedule</span>(<span class="cm-variable">D_MODEL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">optimizer</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">optimizers</span>.<span class="cm-property">Adam</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">learning_rate</span>, <span class="cm-variable">beta_1</span><span class="cm-operator">=</span><span class="cm-number">0.9</span>, <span class="cm-variable">beta_2</span><span class="cm-operator">=</span><span class="cm-number">0.98</span>, <span class="cm-variable">epsilon</span><span class="cm-operator">=</span><span class="cm-number">1e-9</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">accuracy</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">y_pred</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-comment"># ensure labels have shape (batch_size, MAX_LENGTH - 1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">y_true</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">reshape</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">shape</span><span class="cm-operator">=</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">MAX_LENGTH</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">keras</span>.<span class="cm-property">metrics</span>.<span class="cm-property">sparse_categorical_accuracy</span>(<span class="cm-variable">y_true</span>, <span class="cm-variable">y_pred</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">compile</span>(<span class="cm-variable">optimizer</span><span class="cm-operator">=</span><span class="cm-variable">optimizer</span>, <span class="cm-variable">loss</span><span class="cm-operator">=</span><span class="cm-variable">loss_function</span>, <span class="cm-variable">metrics</span><span class="cm-operator">=</span>[<span class="cm-variable">accuracy</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 196px;"></div><div class="CodeMirror-gutters" style="display: none; height: 229px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[42]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 88.6875px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 261.05px; margin-bottom: -17px; border-right-width: 33px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 88.6875px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EPOCHS</span> <span class="cm-operator">=</span> <span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">fit</span>(<span class="cm-variable">dataset</span>, <span class="cm-variable">epochs</span><span class="cm-operator">=</span><span class="cm-variable">EPOCHS</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 95px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Epoch 1/10
690/690 [==============================] - 1283s 2s/step - loss: 2.1140 - accuracy: 0.0416
Epoch 2/10
690/690 [==============================] - 1266s 2s/step - loss: 1.5006 - accuracy: 0.0787
Epoch 3/10
690/690 [==============================] - 1242s 2s/step - loss: 1.3972 - accuracy: 0.0856
Epoch 4/10
690/690 [==============================] - 1244s 2s/step - loss: 1.3385 - accuracy: 0.0900
Epoch 5/10
690/690 [==============================] - 1247s 2s/step - loss: 1.2868 - accuracy: 0.0943
Epoch 6/10
690/690 [==============================] - 1264s 2s/step - loss: 1.2405 - accuracy: 0.0977
Epoch 7/10
690/690 [==============================] - 1265s 2s/step - loss: 1.1864 - accuracy: 0.1017
Epoch 8/10
690/690 [==============================] - 4518s 7s/step - loss: 1.1253 - accuracy: 0.1071
Epoch 9/10
690/690 [==============================] - 1310s 2s/step - loss: 1.0692 - accuracy: 0.1124
Epoch 10/10
690/690 [==============================] - 1251s 2s/step - loss: 1.0150 - accuracy: 0.1184
</pre></div></div><div class="output_area"><div class="run_this_cell"></div><div class="prompt output_prompt"><bdi>Out[42]:</bdi></div><div class="output_subarea output_text output_result" dir="auto"><pre>&lt;tensorflow.python.keras.callbacks.History at 0x1f70389d788&gt;</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[43]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 593.6px; left: 211.85px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 615.1px; margin-bottom: -17px; border-right-width: 33px; min-height: 616px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 211.85px; top: 588px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">evaluate</span>(<span class="cm-variable">sentence</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">preprocess_sentence</span>(<span class="cm-variable">sentence</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">expand_dims</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-variable">START_TOKEN</span> <span class="cm-operator">+</span> <span class="cm-variable">tokenizer</span>.<span class="cm-property">encode</span>(<span class="cm-variable">sentence</span>) <span class="cm-operator">+</span> <span class="cm-variable">END_TOKEN</span>, <span class="cm-variable">axis</span><span class="cm-operator">=</span><span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">output</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">expand_dims</span>(<span class="cm-variable">START_TOKEN</span>, <span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">MAX_LENGTH</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">predictions</span> <span class="cm-operator">=</span> <span class="cm-variable">model</span>(<span class="cm-variable">inputs</span><span class="cm-operator">=</span>[<span class="cm-variable">sentence</span>, <span class="cm-variable">output</span>], <span class="cm-variable">training</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># select the last word from the seq_len dimension</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">predictions</span> <span class="cm-operator">=</span> <span class="cm-variable">predictions</span>[:, <span class="cm-operator">-</span><span class="cm-number">1</span>:, :]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">predicted_id</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">cast</span>(<span class="cm-variable">tf</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">predictions</span>, <span class="cm-variable">axis</span><span class="cm-operator">=-</span><span class="cm-number">1</span>), <span class="cm-variable">tf</span>.<span class="cm-property">int32</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># return the result if the predicted_id is equal to the end token</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">tf</span>.<span class="cm-property">equal</span>(<span class="cm-variable">predicted_id</span>, <span class="cm-variable">END_TOKEN</span>[<span class="cm-number">0</span>]):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      <span class="cm-keyword cm-error">break</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># concatenated the predicted_id to the output which is given to the decoder</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># as its input.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">output</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">concat</span>([<span class="cm-variable">output</span>, <span class="cm-variable">predicted_id</span>], <span class="cm-variable">axis</span><span class="cm-operator">=-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">tf</span>.<span class="cm-property">squeeze</span>(<span class="cm-variable">output</span>, <span class="cm-variable">axis</span><span class="cm-operator">=</span><span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">predict</span>(<span class="cm-variable">sentence</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">prediction</span> <span class="cm-operator">=</span> <span class="cm-variable">evaluate</span>(<span class="cm-variable">sentence</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable">predicted_sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenizer</span>.<span class="cm-property">decode</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">      [<span class="cm-variable">i</span> <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">prediction</span> <span class="cm-keyword">if</span> <span class="cm-variable">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">tokenizer</span>.<span class="cm-property">vocab_size</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-builtin cm-error">print</span>(<span class="cm-string">'Input: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">sentence</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-builtin">print</span>(<span class="cm-string">'Output: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">predicted_sentence</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-keyword cm-error">return</span> <span class="cm-variable">predicted_sentence</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 616px;"></div><div class="CodeMirror-gutters" style="display: none; height: 649px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[44]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 311.925px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 314.925px; margin-bottom: -17px; border-right-width: 33px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 311.925px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">output</span> <span class="cm-operator">=</span> <span class="cm-variable">predict</span>(<span class="cm-string">'Where have you been?'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 61px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Input: Where have you been?
Output: i m fine .
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[45]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56px; left: 88.6875px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 414.975px; margin-bottom: -17px; border-right-width: 33px; min-height: 78px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 88.6875px; top: 50.4px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sentence</span> <span class="cm-operator">=</span> <span class="cm-string">'I am not crazy, my mother had me tested.'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">_</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">5</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">sentence</span> <span class="cm-operator">=</span> <span class="cm-variable">predict</span>(<span class="cm-variable">sentence</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-builtin">print</span>(<span class="cm-string">''</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 111px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Input: I am not crazy, my mother had me tested.
Output: i m not going to tell you what ?

Input: i m not going to tell you what ?
Output: i m going to go to bed .

Input: i m going to go to bed .
Output: i m not going to tell you what ?

Input: i m not going to tell you what ?
Output: i m going to go to bed .

Input: i m going to go to bed .
Output: i m not going to tell you what ?

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell running rendered unselected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[*]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 72.8px; left: 157.975px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 276.45px; margin-bottom: -17px; border-right-width: 33px; min-height: 95px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 157.975px; top: 67.2px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">_</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">50</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-variable cm-error">output</span> <span class="cm-operator">=</span> <span class="cm-variable">predict</span>(<span class="cm-builtin">input</span>(<span class="cm-string">"Enter:"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">output</span> <span class="cm-operator">=</span> <span class="cm-variable">predict</span>(<span class="cm-string">''</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 95px;"></div><div class="CodeMirror-gutters" style="display: none; height: 128px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout" dir="auto"><pre>Enter:i want a drink
Input: i want a drink
Output: i m not going to do anything you want .
Enter:do you know engineering
Input: do you know engineering
Output: i m not going to go to dinner .
Enter:want something to eat?
Input: want something to eat?
Output: i don t know .
</pre></div></div><div class="output_area"><div class="run_this_cell"></div><div class="prompt"></div><div class="box-flex1 output_subarea raw_input_container" dir="auto"><pre class="raw_input_prompt">Enter:<input class="raw_input" type="text" size="47"></pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unrendered selected" tabindex="2"><div class="input"><div class="prompt_container"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="run_this_cell" title="Run this cell"><i class="fa-step-forward fa"></i></div></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area" aria-label="Edit code here"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 7px; margin-bottom: -17px; border-right-width: 33px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16.8px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 33px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 61px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output"></div><div class="output"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="button" class="ui-button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="http://localhost:8888/notebooks/Chatbotoff2.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"notebook_version": "6.2.0", "notebook_path": "C:\\Users\\gaura\\anaconda3\\envs\\chatbot1\\lib\\site-packages\\notebook", "commit_source": "", "commit_hash": "", "sys_version": "3.7.10 (default, Feb 26 2021, 13:06:18) [MSC v.1916 64 bit (AMD64)]", "sys_executable": "C:\\Users\\gaura\\anaconda3\\envs\\chatbot1\\python.exe", "sys_platform": "win32", "platform": "Windows-10-10.0.17763-SP0", "os_name": "nt", "default_encoding": "utf-8"};
</script>

<script src="./Chatbotoff2 - Jupyter Notebook_files/encoding.js.download" charset="utf-8"></script>

<script src="./Chatbotoff2 - Jupyter Notebook_files/main.min.js.download" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal;"></div></div></body></html>